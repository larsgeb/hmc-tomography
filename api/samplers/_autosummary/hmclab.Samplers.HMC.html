<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HMC &mdash; HMCLab archive/parallel-tempering-33-g7bdeca4-dirty documentation</title>
      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/autoclasstoc.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script src="https://unpkg.com/@jupyter-widgets/html-manager@^0.20.0/dist/embed-amd.js"></script>
        <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Optimizers" href="../../optimizers/index.html" />
    <link rel="prev" title="RWMH" href="hmclab.Samplers.RWMH.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> HMCLab
            <img src="../../../_static/hmctom.png" class="logo" alt="Logo"/>
          </a>
              <div class="version">
                archive/parallel-tempering-33-g7bdeca4-dirty
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../index.html">HMC Tomography</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../hmc.html">The Hamiltonian Monte Carlo algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../setup.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../notebooks.html">Notebooks: Examples and tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../index.html">API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../distributions/index.html">Distributions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../massmatrices/index.html">MassMatrices</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html">Samplers</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="hmclab.Samplers._AbstractSampler.html">_AbstractSampler</a></li>
<li class="toctree-l3"><a class="reference internal" href="hmclab.Samplers.RWMH.html">RWMH</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">HMC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../optimizers/index.html">Optimizers</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../visualization/index.html">Visualization</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../_autosummary/hmclab.Samples.html">Samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../py-modindex.html">Module index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../genindex.html">Alphabetic index</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">HMCLab</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../index.html">API reference</a> &raquo;</li>
          <li><a href="../index.html">Samplers</a> &raquo;</li>
      <li>HMC</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../../_sources/api/samplers/_autosummary/hmclab.Samplers.HMC.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="hmc">
<h1>HMC<a class="headerlink" href="#hmc" title="Permalink to this headline"></a></h1>
<dl class="py class">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC">
<em class="property"><span class="pre">class</span> </em><span class="sig-prename descclassname"><span class="pre">hmclab.Samplers.</span></span><span class="sig-name descname"><span class="pre">HMC</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/hmclab/Samplers.html#HMC"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hmclab.Samplers.HMC" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="hmclab.Samplers._AbstractSampler.html#hmclab.Samplers._AbstractSampler" title="hmclab.Samplers._AbstractSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">hmclab.Samplers._AbstractSampler</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.__init__">
<span class="sig-name descname"><span class="pre">__init__</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hmclab.Samplers.HMC.__init__" title="Permalink to this definition"></a></dt>
<dd><p>Constructor that sets the random number generator for the sampler. Pass a
seed to make a Markov chain reproducible (given that all settings are re-used.)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> (<em>int</em>) – Description of parameter <cite>seed</cite>.</p>
</dd>
</dl>
</dd></dl>

<p class="rubric">Methods</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.__init__" title="hmclab.Samplers.HMC.__init__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__init__</span></code></a></p></td>
<td><p>Constructor that sets the random number generator for the sampler.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">autotune</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_diagnostics</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">load_results</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_acceptance_rate</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">plot_stepsizes</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.print_results" title="hmclab.Samplers.HMC.print_results"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print_results</span></code></a></p></td>
<td><p>Print Jupyter widget from <cite>_repr_html_()</cite> to stdout.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.sample" title="hmclab.Samplers.HMC.sample"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sample</span></code></a></p></td>
<td><p>Sampling using the Hamiltonian Monte Carlo algorithm.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.acceptance_rates" title="hmclab.Samplers.HMC.acceptance_rates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">acceptance_rates</span></code></a></p></td>
<td><p>A NumPy ndarray containing all past acceptance rates.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">accepted_proposals</span></code></p></td>
<td><p>An integer representing the amount of accepted proposals.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.amount_of_steps" title="hmclab.Samplers.HMC.amount_of_steps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">amount_of_steps</span></code></a></p></td>
<td><p>A positive integer representing the amount of integration steps to be used in solving Hamiltons equations.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">amount_of_writes</span></code></p></td>
<td><p>A positive integer representing the amount of times the sampler has written to disk.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.autotuning" title="hmclab.Samplers.HMC.autotuning"><code class="xref py py-obj docutils literal notranslate"><span class="pre">autotuning</span></code></a></p></td>
<td><p>A boolean indicating if the stepsize is tuned towards a specific acceptance rate using diminishing adaptive parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">available_integrators</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.current_h" title="hmclab.Samplers.HMC.current_h"><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_h</span></code></a></p></td>
<td><p>A float representing the total energy associated with the current state.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.current_k" title="hmclab.Samplers.HMC.current_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_k</span></code></a></p></td>
<td><p>A float representing the kinetic energy associated with the current state.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_model</span></code></p></td>
<td><p>A NumPy array containing the model at the current state of the Markov chain.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.current_momentum" title="hmclab.Samplers.HMC.current_momentum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_momentum</span></code></a></p></td>
<td><p>A NumPy ndarray (shape dimensions × 1) containing the momentum at the current state of the Markov chain.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_proposal</span></code></p></td>
<td><p>An integer representing the current proposal index (before thinning) of the Markov chain.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_proposal_after_thinning</span></code></p></td>
<td><p>An integer representing the current proposal index after thinning of the Markov chain.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">current_x</span></code></p></td>
<td><p>A float containing <span class="math notranslate nohighlight">\(\chi = -\log\left( p\right)\)</span> (i.e.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">diagnostic_mode</span></code></p></td>
<td><p>Boolean describing whether functions need to be profiled for performance.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">dimensions</span></code></p></td>
<td><p>An integer representing the dimensionality in which the MCMC sampler works.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">disable_progressbar</span></code></p></td>
<td><p>A bool describing whether or not to disable the TQDM progressbar</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">distribution</span></code></p></td>
<td><p>The _AbstractDistribution-derived object on which the sampler works.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">end_time</span></code></p></td>
<td><p>Time (and date) at which sampling was terminated / finished.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">exchange_interval</span></code></p></td>
<td><p>Integer describing how many samples lie between the attempted swap of states between samplers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">exchange_schedule</span></code></p></td>
<td><p>A pre-communicated exchange schedule determining when and which samplers try to exchange states.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">functions_to_diagnose</span></code></p></td>
<td><p>Array of functions to be profiled, typically contains functions only from the abstract base class.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrator</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrators</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">integrators_full_names</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.learning_rate" title="hmclab.Samplers.HMC.learning_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">learning_rate</span></code></a></p></td>
<td><p>A float tuning the rate of decrease at which a new step size is adapted, according to rate = (iteration_number) ** (-learning_rate).</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">main_thread_keyboard_interrupt</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.mass_matrix" title="hmclab.Samplers.HMC.mass_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">mass_matrix</span></code></a></p></td>
<td><p>An object representing the artificial masses assigned to each parameters.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">max_time</span></code></p></td>
<td><p>A float representing the maximum time in seconds that sampling is allowed to take before it is automatically terminated.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.minimal_stepsize" title="hmclab.Samplers.HMC.minimal_stepsize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">minimal_stepsize</span></code></a></p></td>
<td><p>Minimal stepsize which is chosen if stepsize becomes zero or negative during autotuning.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.name" title="hmclab.Samplers.HMC.name"><code class="xref py py-obj docutils literal notranslate"><span class="pre">name</span></code></a></p></td>
<td><p>Sampler name.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">online_thinning</span></code></p></td>
<td><p>An integer representing the interval between stored samples.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">parallel</span></code></p></td>
<td><p>A boolean describing if this sampler works in an array of multiple samplers.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">pipe_matrix</span></code></p></td>
<td><p>A matrix of two-way communicators between samplers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">progressbar_refresh_rate</span></code></p></td>
<td><p>A float representing how many seconds lies between an update of the progress bar statistics (acceptance rate etc.).</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposals</span></code></p></td>
<td><p>An integer representing the amount of requested proposals for a run.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.proposed_h" title="hmclab.Samplers.HMC.proposed_h"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposed_h</span></code></a></p></td>
<td><p>A float representing the total energy associated with the proposed state.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.proposed_k" title="hmclab.Samplers.HMC.proposed_k"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposed_k</span></code></a></p></td>
<td><p>A float representing the kinetic energy associated with the proposed state.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposed_model</span></code></p></td>
<td><p>A NumPy array containing the model at the proposed state of the Markov chain.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.proposed_momentum" title="hmclab.Samplers.HMC.proposed_momentum"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposed_momentum</span></code></a></p></td>
<td><p>A NumPy ndarray (shape dimensions × 1) containing the momentum at the proposed state of the Markov chain.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">proposed_x</span></code></p></td>
<td><p>A float containing <span class="math notranslate nohighlight">\(\chi = -\log\left( p\right)\)</span> (i.e.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ram_buffer</span></code></p></td>
<td><p>A NumPy ndarray containing the samples that are as of yet not written to disk.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">ram_buffer_size</span></code></p></td>
<td><p>A positive integer indicating the size of the RAM buffer in amount of samples.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.randomize_stepsize" title="hmclab.Samplers.HMC.randomize_stepsize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">randomize_stepsize</span></code></a></p></td>
<td><p>Boolean describing whether or not to randomize the stepsize slightly for every trajectory, by a Uniform~[0.5-1.5] * stepsize.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">rng</span></code></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampler_index</span></code></p></td>
<td><p>An integer describing the index of the parallel sampler in the array of samplers.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">sampler_specific_functions_to_diagnose</span></code></p></td>
<td><p>Array of sampler specific functions to be profiled.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">samples_hdf5_dataset</span></code></p></td>
<td><p>A string containing the HDF5 group of the hdf5 file to which samples will be stored.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">samples_hdf5_filehandle</span></code></p></td>
<td><p>A HDF5 file handle of the hdf5 file to which samples will be stored.</p></td>
</tr>
<tr class="row-odd"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">samples_hdf5_filename</span></code></p></td>
<td><p>A string containing the path+filename of the hdf5 file to which samples will be stored.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">start_time</span></code></p></td>
<td><p>Time (and date) at which sampling was started.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.stepsize" title="hmclab.Samplers.HMC.stepsize"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stepsize</span></code></a></p></td>
<td><p>A positive float representing the time step to be used in solving Hamiltons equations.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.stepsizes" title="hmclab.Samplers.HMC.stepsizes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">stepsizes</span></code></a></p></td>
<td><p>A NumPy ndarray containing all past stepsizes for the HMC algorithm.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#hmclab.Samplers.HMC.target_acceptance_rate" title="hmclab.Samplers.HMC.target_acceptance_rate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">target_acceptance_rate</span></code></a></p></td>
<td><p>A float representing the optimal acceptance rate used for autotuning, if autotuning is True.</p></td>
</tr>
<tr class="row-even"><td><p><code class="xref py py-obj docutils literal notranslate"><span class="pre">times_started</span></code></p></td>
<td><p>An integer representing how often this sampler object has started sampling.</p></td>
</tr>
</tbody>
</table>
<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.stepsize">
<span class="sig-name descname"><span class="pre">stepsize</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">0.1</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.stepsize" title="Permalink to this definition"></a></dt>
<dd><p>A positive float representing the time step to be used in solving Hamiltons
equations. Has a strong influence on acceptance rate. <strong>An essential tuning
parameter.</strong></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.amount_of_steps">
<span class="sig-name descname"><span class="pre">amount_of_steps</span></span><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><em class="property"> <span class="pre">=</span> <span class="pre">10</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.amount_of_steps" title="Permalink to this definition"></a></dt>
<dd><p>A positive integer representing the amount of integration steps to be used in
solving Hamiltons equations. Has a medium influence on acceptance rate. <strong>An
essential tuning parameter.</strong></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.mass_matrix">
<span class="sig-name descname"><span class="pre">mass_matrix</span></span><em class="property"><span class="pre">:</span> <a class="reference internal" href="../../massmatrices/_autosummary/hmclab.MassMatrices._AbstractMassMatrix.html#hmclab.MassMatrices._AbstractMassMatrix" title="hmclab.MassMatrices._AbstractMassMatrix"><span class="pre">hmclab.MassMatrices._AbstractMassMatrix</span></a></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.mass_matrix" title="Permalink to this definition"></a></dt>
<dd><p>An object representing the artificial masses assigned to each parameters. Needs
to be a subtype of _AbstractMassMatrix. Has a strong influence on convergence rate.
<strong>An essential tuning parameter.</strong></p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.current_momentum">
<span class="sig-name descname"><span class="pre">current_momentum</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.current_momentum" title="Permalink to this definition"></a></dt>
<dd><p>A NumPy ndarray (shape dimensions × 1) containing the momentum at the current
state of the Markov chain. Indicates direction in which the model will initially
move along its numerical trajectory. Will be resampled from the mass matrix for each
proposal.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.current_k">
<span class="sig-name descname"><span class="pre">current_k</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">nan</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.current_k" title="Permalink to this definition"></a></dt>
<dd><p>A float representing the kinetic energy associated with the current state.
Typically follows the ChiSquared[dimensions] distribution.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.print_results">
<span class="sig-name descname"><span class="pre">print_results</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="headerlink" href="#hmclab.Samplers.HMC.print_results" title="Permalink to this definition"></a></dt>
<dd><p>Print Jupyter widget from <cite>_repr_html_()</cite> to stdout.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.current_h">
<span class="sig-name descname"><span class="pre">current_h</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">nan</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.current_h" title="Permalink to this definition"></a></dt>
<dd><p>A float representing the total energy associated with the current state.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.proposed_momentum">
<span class="sig-name descname"><span class="pre">proposed_momentum</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.proposed_momentum" title="Permalink to this definition"></a></dt>
<dd><p>A NumPy ndarray (shape dimensions × 1) containing the momentum at the proposed
state of the Markov chain. Indicates direction in which the model was moving at the
end of its numerical trajectory. Will be computed deterministically from the
current_momentum, i.e. the state the Markov chain started in.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.proposed_k">
<span class="sig-name descname"><span class="pre">proposed_k</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">nan</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.proposed_k" title="Permalink to this definition"></a></dt>
<dd><p>A float representing the kinetic energy associated with the proposed state.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.proposed_h">
<span class="sig-name descname"><span class="pre">proposed_h</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">nan</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.proposed_h" title="Permalink to this definition"></a></dt>
<dd><p>A float representing the total energy associated with the proposed state.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.name">
<span class="sig-name descname"><span class="pre">name</span></span><em class="property"><span class="pre">:</span> <span class="pre">str</span></em><em class="property"> <span class="pre">=</span> <span class="pre">'Hamiltonian</span> <span class="pre">Monte</span> <span class="pre">Carlo'</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.name" title="Permalink to this definition"></a></dt>
<dd><p>Sampler name.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.autotuning">
<span class="sig-name descname"><span class="pre">autotuning</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><em class="property"> <span class="pre">=</span> <span class="pre">False</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.autotuning" title="Permalink to this definition"></a></dt>
<dd><p>A boolean indicating if the stepsize is tuned towards a specific acceptance rate
using diminishing adaptive parameters.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.learning_rate">
<span class="sig-name descname"><span class="pre">learning_rate</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">0.75</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.learning_rate" title="Permalink to this definition"></a></dt>
<dd><p>A float tuning the rate of decrease at which a new step size is adapted,
according to rate = (iteration_number) ** (-learning_rate). Needs to be larger than
0.5 and equal to or smaller than 1.0.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.target_acceptance_rate">
<span class="sig-name descname"><span class="pre">target_acceptance_rate</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">0.65</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.target_acceptance_rate" title="Permalink to this definition"></a></dt>
<dd><p>A float representing the optimal acceptance rate used for autotuning, if
autotuning is True.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.acceptance_rates">
<span class="sig-name descname"><span class="pre">acceptance_rates</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.acceptance_rates" title="Permalink to this definition"></a></dt>
<dd><p>A NumPy ndarray containing all past acceptance rates. Collected if autotuning is
True.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.randomize_stepsize">
<span class="sig-name descname"><span class="pre">randomize_stepsize</span></span><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><em class="property"> <span class="pre">=</span> <span class="pre">True</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.randomize_stepsize" title="Permalink to this definition"></a></dt>
<dd><p>Boolean describing whether or not to randomize the stepsize slightly for every trajectory,
by a Uniform~[0.5-1.5] * stepsize.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.stepsizes">
<span class="sig-name descname"><span class="pre">stepsizes</span></span><em class="property"><span class="pre">:</span> <span class="pre">numpy.ndarray</span></em><em class="property"> <span class="pre">=</span> <span class="pre">None</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.stepsizes" title="Permalink to this definition"></a></dt>
<dd><p>A NumPy ndarray containing all past stepsizes for the HMC algorithm. Collected if
autotuning is True.</p>
</dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.minimal_stepsize">
<span class="sig-name descname"><span class="pre">minimal_stepsize</span></span><em class="property"><span class="pre">:</span> <span class="pre">float</span></em><em class="property"> <span class="pre">=</span> <span class="pre">1e-18</span></em><a class="headerlink" href="#hmclab.Samplers.HMC.minimal_stepsize" title="Permalink to this definition"></a></dt>
<dd><p>Minimal stepsize which is chosen if stepsize becomes zero or negative during
autotuning.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="hmclab.Samplers.HMC.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">samples_hdf5_filename</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">distribution</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="../../distributions/_autosummary/hmclab.Distributions._AbstractDistribution.html#hmclab.Distributions._AbstractDistribution" title="hmclab.Distributions.base._AbstractDistribution"><span class="pre">hmclab.Distributions.base._AbstractDistribution</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepsize</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">amount_of_steps</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mass_matrix</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="../../massmatrices/_autosummary/hmclab.MassMatrices._AbstractMassMatrix.html#hmclab.MassMatrices._AbstractMassMatrix" title="hmclab.MassMatrices._AbstractMassMatrix"><span class="pre">hmclab.MassMatrices._AbstractMassMatrix</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">integrator</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'lf'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_model</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">numpy.ndarray</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">proposals</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">online_thinning</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diagnostic_mode</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ram_buffer_size</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overwrite_existing_file</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_time</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">autotuning</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_acceptance_rate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.65</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">float</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0.75</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">queue</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">disable_progressbar</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/hmclab/Samplers.html#HMC.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#hmclab.Samplers.HMC.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sampling using the Hamiltonian Monte Carlo algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>samples_hdf5_filename</strong> (<em>str</em>) – String containing the (path+)filename of the HDF5 file to contain the
samples. <strong>A required parameter.</strong></p></li>
<li><p><strong>distribution</strong> (<a class="reference internal" href="../../distributions/_autosummary/hmclab.Distributions._AbstractDistribution.html#hmclab.Distributions._AbstractDistribution" title="hmclab.Distributions._AbstractDistribution"><em>_AbstractDistribution</em></a>) – The distribution to sample. Should be an instance of a subclass of
_AbstractDistribution. <strong>A required parameter.</strong></p></li>
<li><p><strong>stepsize</strong> (<em>float</em>) – A positive float representing the time step to be used in solving Hamiltons
equations. Has a strong influence on acceptance rate. <strong>An essential tuning
parameter.</strong></p></li>
<li><p><strong>amount_of_steps</strong> (<em>int</em>) – A positive integer representing the amount of integration steps to be used
in solving Hamiltons equations. Has a medium influence on acceptance rate.
<strong>An essential tuning parameter.</strong></p></li>
<li><p><strong>mass_matrix</strong> (<a class="reference internal" href="../../massmatrices/_autosummary/hmclab.MassMatrices._AbstractMassMatrix.html#hmclab.MassMatrices._AbstractMassMatrix" title="hmclab.MassMatrices._AbstractMassMatrix"><em>_AbstractMassMatrix</em></a>) – An object representing the artificial masses assigned to each parameters.
Needs to be a subtype of _AbstractMassMatrix. Has a strong influence on
convergence rate. One passing None, defaults to the Unit mass matrix. <strong>An
essential tuning parameter.</strong></p></li>
<li><p><strong>integrator</strong> (<em>str</em>) – String containing “lf”, “3s” or “4s” for a leapfrog, 3-stage or 4-stage
symplectic integrator respectively, to be used during the trajectory
calculation.</p></li>
<li><p><strong>initial_model</strong> (<em>_numpy</em>) – A NumPy column vector (shape dimensions × 1) containing the starting model
of the Markov chain. This model will not be written out as a sample.</p></li>
<li><p><strong>proposals</strong> (<em>int</em>) – An integer representing the amount of proposals the algorithm should make.</p></li>
<li><p><strong>online_thinning</strong> (<em>int</em>) – An integer representing the degree of online thinning, i.e. the interval
between storing samples.</p></li>
<li><p><strong>diagnostic_mode</strong> (<em>bool</em>) – A boolean describing if subroutines of sampling should be timed. Useful for
finding slow parts of the algorithm. Will add overhead to each function.</p></li>
<li><p><strong>ram_buffer_size</strong> (<em>int</em>) – An integer representing how many samples should be kept in RAM before
writing to storage.</p></li>
<li><p><strong>overwrite_existing_file</strong> (<em>bool</em>) – A boolean describing whether or not to silently overwrite existing files.
Use with caution.</p></li>
<li><p><strong>max_time</strong> (<em>float</em>) – A float representing the maximum time in seconds that sampling is allowed to
take before it is automatically terminated. The value None is used for
unlimited time.</p></li>
<li><p><strong>autotuning</strong> (<em>bool</em>) – A boolean describing whether or not stepsize is automatically adjusted. Uses
a diminishing adapting scheme to satisfy detailed balance.</p></li>
<li><p><strong>target_acceptance_rate</strong> (<em>float</em>) – A float between 0.0 and 1.0 that is the target acceptance rate of
autotuning. The algorithm will try to achieve this acceptance rate.</p></li>
<li><p><strong>learning_rate</strong> (<em>float</em>) – A float larger than 0.5 but smaller than or equal to 1.0, describing how
aggressively the stepsize is updated. Lower is more aggresive.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>AssertionError</strong> – For any unspecified invalid entry.</p></li>
<li><p><strong>ValueError</strong> – For any invalid value of algorithm settings.</p></li>
<li><p><strong>TypeError</strong> – For any invalid value of algorithm settings.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="hmclab.Samplers.RWMH.html" class="btn btn-neutral float-left" title="RWMH" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../../optimizers/index.html" class="btn btn-neutral float-right" title="Optimizers" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2019-2021, Andrea Zunino, Andreas Fichtner, Lars Gebraad.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>